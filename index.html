<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlavourAI - Futuristic AI Chef</title>
    <style>
        /* ======================================= */
        /* FUTURISTIC CSS STYLES - TAILWIND INSPIRED */
        /* ======================================= */
        
        :root {
            --color-neon-primary: #00f5ff; /* Neon Cyan */
            --color-neon-secondary: #ff00ff; /* Neon Magenta */
            --color-neon-accent: #39ff14; /* Neon Green */
            --color-neon-admin: #ffaa00; /* Neon Orange for Admin */
            --color-dark-bg: #0a0a0f;
            --color-darker-bg: #111827;
            --color-card-bg: #1a1f2e;
            --color-card-hover: #222938;
            --color-text: #e2e8f0;
            --color-text-light: #94a3b8;
            --color-error: #ff2e4d;
            --color-success: #00ff88;
            --border-radius: 12px;
            --glow-primary: 0 0 20px rgba(0, 245, 255, 0.5);
            --glow-secondary: 0 0 20px rgba(255, 0, 255, 0.3);
            --glow-accent: 0 0 15px rgba(57, 255, 20, 0.4);
            --glow-admin: 0 0 15px rgba(255, 170, 0, 0.4);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, var(--color-dark-bg) 0%, var(--color-darker-bg) 100%);
            color: var(--color-text);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            line-height: 1.6;
        }

        header {
            background: rgba(26, 31, 46, 0.8);
            backdrop-filter: blur(10px);
            padding: 1.5em 0;
            text-align: center;
            border-bottom: 1px solid rgba(0, 245, 255, 0.2);
            box-shadow: var(--glow-primary);
        }

        header h1 {
            margin: 0;
            color: var(--color-neon-primary);
            font-size: 2.5em;
            letter-spacing: 2px;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(0, 245, 255, 0.7);
        }

        /* NAWIGACJA */
        nav {
            background: rgba(17, 24, 39, 0.9);
            backdrop-filter: blur(10px);
            padding: 0.8em 0;
            text-align: center;
            border-bottom: 1px solid rgba(255, 0, 255, 0.2);
            box-shadow: var(--glow-secondary);
        }

        nav button {
            background: transparent;
            border: 1px solid rgba(255, 0, 255, 0.3);
            cursor: pointer;
            padding: 0.8em 1.5em;
            font-size: 1em;
            color: var(--color-text-light);
            transition: all 0.3s ease;
            border-radius: var(--border-radius);
            margin: 0 5px;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        nav button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 0, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        nav button:hover {
            color: var(--color-text);
            border-color: var(--color-neon-secondary);
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.5);
        }

        nav button:hover::before {
            left: 100%;
        }

        /* KONTENER G≈Å√ìWNY */
        main {
            padding: 30px 20px;
            flex-grow: 1;
            max-width: 1200px;
            width: 95%;
            margin: 30px auto;
            background: rgba(26, 31, 46, 0.7);
            backdrop-filter: blur(10px);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            border-radius: var(--border-radius);
            border: 1px solid rgba(0, 245, 255, 0.1);
            position: relative;
        }

        h2 {
            color: var(--color-neon-accent);
            border-bottom: 2px solid var(--color-neon-primary);
            padding-bottom: 12px;
            margin-bottom: 30px;
            font-weight: 600;
            text-shadow: 0 0 5px rgba(57, 255, 20, 0.5);
        }

        h3 {
            color: var(--color-neon-primary);
            font-weight: 500;
            margin-top: 25px;
            text-shadow: 0 0 5px rgba(0, 245, 255, 0.5);
        }

        /* FORMY I INPUTY */
        form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        label {
            color: var(--color-text-light);
            font-size: 0.9em;
            margin-bottom: -10px;
            display: block;
        }

        input[type="email"],
        input[type="password"],
        input[type="text"],
        input[type="number"],
        textarea,
        select {
            padding: 14px;
            border: 1px solid rgba(0, 245, 255, 0.3);
            border-radius: var(--border-radius);
            font-size: 1em;
            background: rgba(17, 24, 39, 0.7);
            color: var(--color-text);
            transition: all 0.3s ease;
            resize: vertical;
        }
        
        textarea {
            min-height: 100px;
        }

        input:focus, textarea:focus, select:focus {
            border-color: var(--color-neon-primary);
            box-shadow: var(--glow-primary);
            outline: none;
            background: rgba(17, 24, 39, 0.9);
        }

        /* DYNAMICZNE SK≈ÅADNIKI V2 */
        #ingridient-inputs-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .ingridient-input-group {
            display: grid;
            grid-template-columns: 2fr 1.5fr 40px; 
            gap: 10px;
            align-items: center;
            background: rgba(17, 24, 39, 0.7);
            padding: 10px;
            border-radius: var(--border-radius);
            border: 1px solid rgba(0, 245, 255, 0.2);
        }

        .ingridient-input-group input {
            padding: 10px;
            border: none;
            background: rgba(26, 31, 46, 0.8);
            color: var(--color-text);
            border-radius: 6px;
        }

        .ingridient-input-group input:focus {
            box-shadow: 0 0 8px rgba(0, 245, 255, 0.3);
        }

        .remove-ingridient-btn {
            background-color: var(--color-error);
            color: white;
            border: none;
            padding: 8px 0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.2s ease;
        }

        .remove-ingridient-btn:hover {
            background-color: #ff1a40;
            box-shadow: 0 0 10px rgba(255, 46, 77, 0.5);
        }
        
        .add-ingridient-btn {
            background: linear-gradient(135deg, var(--color-neon-primary), var(--color-neon-secondary));
            color: var(--color-dark-bg);
            border: none;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .add-ingridient-btn:hover {
            box-shadow: var(--glow-primary), var(--glow-secondary);
            transform: translateY(-2px);
        }

        /* PRZYCISKI */
        .btn {
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--color-neon-primary), var(--color-neon-secondary));
            color: var(--color-dark-bg);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover {
            box-shadow: var(--glow-primary), var(--glow-secondary);
            transform: translateY(-2px);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-generate {
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--color-neon-accent), #00cc66);
            color: var(--color-dark-bg);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-generate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn-generate:hover {
            box-shadow: var(--glow-accent);
            transform: translateY(-2px);
        }

        .btn-generate:hover::before {
            left: 100%;
        }

        .btn-secondary {
            background: rgba(57, 255, 20, 0.1);
            color: var(--color-neon-accent);
            border: 1px solid rgba(57, 255, 20, 0.3);
            padding: 10px 18px;
            font-weight: normal;
        }

        .btn-secondary:hover {
            background: rgba(57, 255, 20, 0.2);
            color: var(--color-text);
            box-shadow: var(--glow-accent);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--color-error), #ff1a40);
            margin-top: 15px;
        }
        .btn-danger:hover {
            box-shadow: 0 0 15px rgba(255, 46, 77, 0.7);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--color-neon-admin), #ff8800);
            color: var(--color-dark-bg);
        }
        .btn-warning:hover {
            box-shadow: var(--glow-admin);
        }

        .btn-back {
            background: rgba(148, 163, 184, 0.1);
            color: var(--color-text);
            border: 1px solid rgba(148, 163, 184, 0.3);
            padding: 10px 15px;
            margin-bottom: 25px;
        }
        .btn-back:hover {
            background: rgba(148, 163, 184, 0.2);
            box-shadow: 0 0 10px rgba(148, 163, 184, 0.3);
        }

        /* ALERTY I WIADOMO≈öCI */
        .message-box {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: var(--border-radius);
            font-weight: 500;
            text-align: center;
            display: none;
            backdrop-filter: blur(10px);
        }

        .message-box.error {
            background: rgba(255, 46, 77, 0.1);
            color: var(--color-error);
            border: 1px solid rgba(255, 46, 77, 0.3);
            box-shadow: 0 0 10px rgba(255, 46, 77, 0.2);
        }

        .message-box.success {
            background: rgba(0, 255, 136, 0.1);
            color: var(--color-success);
            border: 1px solid rgba(0, 255, 136, 0.3);
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
        }

        .message-box.warning {
            background: rgba(255, 170, 0, 0.1);
            color: var(--color-neon-admin);
            border: 1px solid rgba(255, 170, 0, 0.3);
            box-shadow: 0 0 10px rgba(255, 170, 0, 0.2);
        }

        /* WIDOKI SPA */
        .view {
            display: none;
        }

        .view.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* SEKCJA PRZEPIS√ìW */
        .recipe-list {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .recipe-item {
            background: rgba(26, 31, 46, 0.8);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border: 1px solid rgba(0, 245, 255, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .recipe-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--color-neon-primary), var(--color-neon-secondary));
        }
        
        .recipe-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5), var(--glow-primary);
            border-color: rgba(0, 245, 255, 0.3);
        }

        .recipe-item h3 {
            margin-top: 0;
            color: var(--color-neon-primary);
            font-size: 1.4em;
            border-bottom: 1px solid rgba(0, 245, 255, 0.3);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .recipe-item p {
            margin: 5px 0;
            font-size: 0.95em;
        }

        .recipe-actions {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .recipe-actions button {
            flex-grow: 1;
            font-size: 0.9em;
        }

        /* PANEL ADMINA - LISTA U≈ªYTKOWNIK√ìW */
        .user-list {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        .user-item {
            background: rgba(26, 31, 46, 0.8);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border: 1px solid rgba(255, 170, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .user-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--color-neon-admin), #ff8800);
        }
        
        .user-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5), var(--glow-admin);
            border-color: rgba(255, 170, 0, 0.4);
        }

        .user-item h3 {
            margin-top: 0;
            color: var(--color-neon-admin);
            font-size: 1.4em;
            border-bottom: 1px solid rgba(255, 170, 0, 0.3);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .user-item p {
            margin: 5px 0;
            font-size: 0.95em;
        }

        .user-actions {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .user-actions button {
            flex-grow: 1;
            font-size: 0.9em;
        }

        .admin-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--color-neon-admin), #ff8800);
            color: var(--color-dark-bg);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }
        
        /* Szczeg√≥≈Çy Przepisu */
        .recipe-display-content { 
            background: rgba(26, 31, 46, 0.8);
            padding: 30px;
            border-radius: var(--border-radius);
            line-height: 1.8;
            border: 1px solid rgba(0, 245, 255, 0.1);
        }
        
        .recipe-display-content h4 {
            color: var(--color-neon-accent);
            border-left: 3px solid var(--color-neon-accent);
            padding-left: 10px;
            margin-top: 30px;
            margin-bottom: 15px;
            text-shadow: 0 0 5px rgba(57, 255, 20, 0.3);
        }
        
        .recipe-display-content ul, .recipe-display-content ol {
            padding-left: 20px;
        }
        
        .recipe-display-content ul li::before {
            content: "‚ñ∏";
            color: var(--color-neon-primary);
            font-weight: bold;
            display: inline-block; 
            width: 1em;
            margin-left: -1em;
        }
        
        hr {
            border: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--color-neon-primary), transparent);
            margin: 30px 0;
        }

        /* STOPKA */
        footer {
            text-align: center;
            padding: 1.5em;
            margin-top: auto;
            background: rgba(26, 31, 46, 0.8);
            color: var(--color-text-light);
            font-size: 0.9em;
            border-top: 1px solid rgba(0, 245, 255, 0.1);
        }
        
        /* ======================================= */
        /* LOADER STYLES - FROM UIVERSE.IO */
        /* ======================================= */
        
        @keyframes square-animation {
            0% {
                left: 0;
                top: 0;
            }

            10.5% {
                left: 0;
                top: 0;
            }

            12.5% {
                left: 32px;
                top: 0;
            }

            23% {
                left: 32px;
                top: 0;
            }

            25% {
                left: 64px;
                top: 0;
            }

            35.5% {
                left: 64px;
                top: 0;
            }

            37.5% {
                left: 64px;
                top: 32px;
            }

            48% {
                left: 64px;
                top: 32px;
            }

            50% {
                left: 32px;
                top: 32px;
            }

            60.5% {
                left: 32px;
                top: 32px;
            }

            62.5% {
                left: 32px;
                top: 64px;
            }

            73% {
                left: 32px;
                top: 64px;
            }

            75% {
                left: 0;
                top: 64px;
            }

            85.5% {
                left: 0;
                top: 64px;
            }

            87.5% {
                left: 0;
                top: 32px;
            }

            98% {
                left: 0;
                top: 32px;
            }

            100% {
                left: 0;
                top: 0;
            }
        }

        .loader {
            position: relative;
            width: 96px;
            height: 96px;
            transform: rotate(45deg);
        }

        .loader-square {
            position: absolute;
            top: 0;
            left: 0;
            width: 28px;
            height: 28px;
            margin: 2px;
            border-radius: 0px;
            background: var(--color-neon-primary);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            animation: square-animation 10s ease-in-out infinite both;
            box-shadow: 0 0 10px var(--color-neon-primary);
        }

        .loader-square:nth-of-type(0) {
            animation-delay: 0s;
        }

        .loader-square:nth-of-type(1) {
            animation-delay: -1.4285714286s;
            background: var(--color-neon-secondary);
            box-shadow: 0 0 10px var(--color-neon-secondary);
        }

        .loader-square:nth-of-type(2) {
            animation-delay: -2.8571428571s;
            background: var(--color-neon-accent);
            box-shadow: 0 0 10px var(--color-neon-accent);
        }

        .loader-square:nth-of-type(3) {
            animation-delay: -4.2857142857s;
            background: var(--color-neon-primary);
            box-shadow: 0 0 10px var(--color-neon-primary);
        }

        .loader-square:nth-of-type(4) {
            animation-delay: -5.7142857143s;
            background: var(--color-neon-secondary);
            box-shadow: 0 0 10px var(--color-neon-secondary);
        }

        .loader-square:nth-of-type(5) {
            animation-delay: -7.1428571429s;
            background: var(--color-neon-accent);
            box-shadow: 0 0 10px var(--color-neon-accent);
        }

        .loader-square:nth-of-type(6) {
            animation-delay: -8.5714285714s;
            background: var(--color-neon-primary);
            box-shadow: 0 0 10px var(--color-neon-primary);
        }

        .loader-square:nth-of-type(7) {
            animation-delay: -10s;
            background: var(--color-neon-secondary);
            box-shadow: 0 0 10px var(--color-neon-secondary);
        }

        #loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 15, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
            border-radius: var(--border-radius);
        }

        #loading-text {
            color: var(--color-text);
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: 500;
            text-align: center;
        }
    </style>
</head>
<body>

    <header>
        <h1>FlavourAI üöÄ</h1>
    </header>

    <nav id="app-nav">
        <!-- Navigation will be populated by JavaScript -->
    </nav>

    <main id="app-container">
        
        <div id="loading-overlay">
            <div class="loader">
                <div class="loader-square"></div>
                <div class="loader-square"></div>
                <div class="loader-square"></div>
                <div class="loader-square"></div>
                <div class="loader-square"></div>
                <div class="loader-square"></div>
                <div class="loader-square"></div>
            </div>
            <p id="loading-text">Mieszamy sk≈Çadniki... AI pracuje!</p>
        </div>

        <!-- Rest of the HTML content remains exactly the same -->
        <section id="login-view" class="view active">
            <h2>Zaloguj siƒô</h2>
            <div id="login-message" class="message-box error"></div>
            <form id="login-form">
                <label for="login-email">E-mail</label>
                <input type="email" id="login-email" placeholder="Adres E-mail" required>
                <label for="login-password">Has≈Ço</label>
                <input type="password" id="login-password" placeholder="Has≈Ço" required>
                <button type="submit" class="btn">Zaloguj</button>
            </form>
            <p style="text-align: center; margin-top: 20px;">
                Nie masz konta? 
                <button onclick="navigate('register-view')" class="btn-secondary" style="background-color: transparent; color: var(--color-neon-secondary); border: 1px solid var(--color-neon-secondary);">Zarejestruj siƒô</button>
            </p>
        </section>

        <section id="register-view" class="view">
            <h2>Utw√≥rz Nowe Konto</h2>
            <div id="register-message" class="message-box"></div>
            <form id="register-form">
                <label for="register-email">E-mail</label>
                <input type="email" id="register-email" placeholder="Adres E-mail" required>
                <label for="register-username">Nazwa u≈ºytkownika</label>
                <input type="text" id="register-username" placeholder="Nazwa u≈ºytkownika" required>
                <label for="register-password">Has≈Ço</label>
                <input type="password" id="register-password" placeholder="Has≈Ço" required>
                <button type="submit" class="btn">Zarejestruj siƒô</button>
            </form>
            <p style="text-align: center; margin-top: 20px;">
                Masz ju≈º konto? 
                <button onclick="navigate('login-view')" class="btn-secondary" style="background-color: transparent; color: var(--color-neon-secondary); border: 1px solid var(--color-neon-secondary);">Zaloguj siƒô</button>
            </p>
        </section>

        <section id="recipes-view" class="view">
            <h2>Twoje Przepisy</h2>
            <div id="recipes-message" class="message-box error"></div>
            <ul id="recipe-list" class="recipe-list">
                <!-- Recipes will be populated by JavaScript -->
            </ul>
        </section>
        
        <section id="generate-recipe-v1-view" class="view">
            <h2>Generuj Przepis - Intencja (V1)</h2>
            <div id="generate-v1-message" class="message-box"></div>
            
            <form id="generate-v1-form">
                <label for="v1-intention">Intencja / Opis potrawy (np. "szybki obiad wegetaria≈Ñski z fasolƒÖ")</label>
                <textarea id="v1-intention" required></textarea>
                
                <label for="v1-maxTime">Maksymalny czas przygotowania (minuty)</label>
                <input type="number" id="v1-maxTime" required min="1" value="45">
                
                <label for="v1-dificultyLevel">Poziom trudno≈õci (1-≈Çatwy, 3-trudny)</label>
                <input type="number" id="v1-dificultyLevel" required min="1" max="3" value="2">
                
                <label for="v1-numberOfPortions">Liczba porcji (opcjonalnie)</label>
                <input type="number" id="v1-numberOfPortions" placeholder="np. 4" min="1">
                
                <button type="submit" class="btn-generate">Wy≈õlij do AI (V1)</button>
            </form>
            
            <div id="v1-recipe-display" class="recipe-display-container" style="display: none;">
                <button onclick="navigate('recipes-view')" class="btn btn-back">‚Üê Powr√≥t do Listy Przepis√≥w</button>
                <h2 id="v1-recipe-title">Wygenerowany Przepis</h2>
                <div id="v1-recipe-content" class="recipe-display-content"></div>
            </div>
        </section>

        <section id="generate-recipe-v2-view" class="view">
            <h2>Generuj Przepis - Sk≈Çadniki (V2)</h2>
            <div id="generate-v2-message" class="message-box"></div>
            
            <form id="generate-v2-form">
                
                <label for="ingridient-inputs-container">Lista posiadanych sk≈Çadnik√≥w i ilo≈õƒá (np. 'cebula', '1 szt.')</label>
                <div id="ingridient-inputs-container">
                    <!-- Ingredient inputs will be populated by JavaScript -->
                </div>
                <button type="button" class="add-ingridient-btn" onclick="addIngredientInput()">+ Dodaj Sk≈Çadnik</button>
                
                <hr style="margin: 5px 0 25px 0; border-color: #37474f;">

                <label for="v2-maxTime">Maksymalny czas przygotowania (minuty)</label>
                <input type="number" id="v2-maxTime" required min="1" value="60">
                
                <label for="v2-dificultyLevel">Poziom trudno≈õci (1-≈Çatwy, 3-trudny)</label>
                <input type="number" id="v2-dificultyLevel" required min="1" max="3" value="1">
                
                <label for="v2-numberOfPortions">Liczba porcji (opcjonalnie)</label>
                <input type="number" id="v2-numberOfPortions" placeholder="np. 2" min="1">
                
                <button type="submit" class="btn-generate">Wy≈õlij do AI (V2)</button>
            </form>
            
            <div id="v2-recipe-display" class="recipe-display-container" style="display: none;">
                <button onclick="navigate('recipes-view')" class="btn btn-back">‚Üê Powr√≥t do Listy Przepis√≥w</button>
                <h2 id="v2-recipe-title">Wygenerowany Przepis</h2>
                <div id="v2-recipe-content" class="recipe-display-content"></div>
            </div>
        </section>
        
        <section id="recipe-details-view" class="view">
            <button onclick="navigate('recipes-view')" class="btn btn-back">‚Üê Powr√≥t do Listy Przepis√≥w</button>
            <h2 id="recipe-details-title">Szczeg√≥≈Çy Przepisu</h2>
            <div id="recipe-details-message" class="message-box error"></div>
            <div id="recipe-display-content" class="recipe-display-content">
                <!-- Recipe details will be populated by JavaScript -->
            </div>
        </section>

        <section id="profile-view" class="view">
            <h2>M√≥j Profil</h2>
            <div id="profile-message" class="message-box"></div>
            
            <div style="background: rgba(26, 31, 46, 0.8); padding: 20px; border-radius: var(--border-radius); margin-bottom: 25px; border: 1px solid rgba(0, 245, 255, 0.1);">
                <p><strong>E-mail:</strong> <span id="user-email"></span></p>
                <p><strong>Nazwa:</strong> <span id="user-username"></span></p>
                <p><strong>Status:</strong> <span id="user-isAdmin"></span></p>
            </div>

            <h3 style="color: var(--color-neon-accent); margin-top: 0;">Edytuj Dane</h3>
            <form id="update-profile-form">
                <label for="newEmail">Nowy E-mail (opcjonalnie)</label>
                <input type="email" id="newEmail" placeholder="Pozostaw puste, by nie zmieniaƒá">
                
                <label for="newPassword">Nowe Has≈Ço (opcjonalnie)</label>
                <input type="password" id="newPassword" placeholder="Pozostaw puste, by nie zmieniaƒá">
                
                <label for="newUsername">Nowa Nazwa u≈ºytkownika (opcjonalnie)</label>
                <input type="text" id="newUsername" placeholder="Pozostaw puste, by nie zmieniaƒá">
                
                <button type="submit" class="btn">Zapisz Zmiany</button>
            </form>

            <hr>

            <h3 style="color: var(--color-error);">Usu≈Ñ Konto</h3>
            <div id="delete-message" class="message-box error"></div>
            <form id="delete-account-form">
                <label for="currentPassword">Twoje aktualne has≈Ço (wymagane do usuniƒôcia)</label>
                <input type="password" id="currentPassword" required>
                <button type="submit" class="btn btn-danger">Trwale Usu≈Ñ Konto</button>
            </form>
        </section>

        <!-- NOWY PANEL ADMINA -->
        <section id="admin-view" class="view">
            <h2>Panel Administratora üõ°Ô∏è</h2>
            <div id="admin-message" class="message-box"></div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                <div style="background: rgba(26, 31, 46, 0.8); padding: 20px; border-radius: var(--border-radius); border: 1px solid rgba(255, 170, 0, 0.3); text-align: center;">
                    <h3 style="color: var(--color-neon-admin); margin-top: 0;">Statystyki</h3>
                    <p><strong>Liczba u≈ºytkownik√≥w:</strong> <span id="users-count">0</span></p>
                    <p><strong>Administratorzy:</strong> <span id="admins-count">0</span></p>
                </div>
                <div style="background: rgba(26, 31, 46, 0.8); padding: 20px; border-radius: var(--border-radius); border: 1px solid rgba(255, 170, 0, 0.3); text-align: center;">
                    <h3 style="color: var(--color-neon-admin); margin-top: 0;">Szybkie Akcje</h3>
                    <button onclick="fetchUsers()" class="btn-warning" style="width: 100%; margin-bottom: 10px;">Od≈õwie≈º Listƒô</button>
                    <button onclick="showAddUserForm()" class="btn" style="width: 100%;">Dodaj U≈ºytkownika</button>
                </div>
            </div>

            <h3>ZarzƒÖdzanie U≈ºytkownikami</h3>
            <ul id="user-list" class="user-list">
                <!-- Users will be populated by JavaScript -->
            </ul>

            <!-- Formularz edycji/dodawania u≈ºytkownika -->
            <div id="user-edit-form" style="display: none; background: rgba(26, 31, 46, 0.8); padding: 30px; border-radius: var(--border-radius); border: 1px solid rgba(255, 170, 0, 0.3); margin-top: 30px;">
                <h3 id="user-form-title" style="color: var(--color-neon-admin);">Edycja U≈ºytkownika</h3>
                <div id="user-form-message" class="message-box"></div>
                
                <form id="admin-user-form">
                    <input type="hidden" id="edit-user-id">
                    
                    <label for="edit-user-email">E-mail</label>
                    <input type="email" id="edit-user-email" required>
                    
                    <label for="edit-user-username">Nazwa u≈ºytkownika</label>
                    <input type="text" id="edit-user-username" required>
                    
                    <label for="edit-user-password">Nowe Has≈Ço (pozostaw puste, by nie zmieniaƒá)</label>
                    <input type="password" id="edit-user-password">
                    
                    <label for="edit-user-isAdmin">Uprawnienia administratora</label>
                    <select id="edit-user-isAdmin">
                        <option value="false">U≈ºytkownik</option>
                        <option value="true">Administrator</option>
                    </select>
                    
                    <div style="display: flex; gap: 15px; margin-top: 20px;">
                        <button type="submit" class="btn-warning" style="flex: 1;">Zapisz Zmiany</button>
                        <button type="button" onclick="hideUserForm()" class="btn-back" style="flex: 1;">Anuluj</button>
                    </div>
                </form>
            </div>
        </section>

    </main>

    <footer>
        <p>FlavourAI &copy; 2025 | Futuristic AI Chef</p>
    </footer>

    <script>
        // =======================================
        //           JAVASCRIPT - Vanilla JS
        // =======================================
        
        // --- Konfiguracja i Sta≈Çe ---
        const HOST = ""
        const API_PORT = 8080;
        const API_BASE_URL = `http://${HOST}:${API_PORT}/apiv1`; 
        const TOKEN_KEY = 'jwtTokenFlavourAI';
        let currentUser = null; 

        // --- Funkcje ≈Åadowania (Loading Spinner) ---
        function showLoading() {
            document.getElementById('loading-overlay').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading-overlay').style.display = 'none';
        }

        // --- Funkcje Dynamicznego Inputu Sk≈Çadnik√≥w V2 ---
        
        function addIngredientInput(name = '', amount = '') {
            const container = document.getElementById('ingridient-inputs-container');
            
            if (container.children.length === 0) {
                 // Dodaj 3 domy≈õlne pola, aby u≈ºytkownik widzia≈Ç, jak zaczƒÖƒá
                 _createIngredientGroup(container, 'cebula', '1 szt.');
                 _createIngredientGroup(container, 'jajka', '3 szt.');
                 _createIngredientGroup(container, 'ser ≈º√≥≈Çty', '100 g');
            } else {
                 _createIngredientGroup(container, name, amount);
            }
        }
        
        function _createIngredientGroup(container, name, amount) {
            const group = document.createElement('div');
            group.className = 'ingridient-input-group';
            
            group.innerHTML = `
                <input type="text" class="ingridient-name" placeholder="Nazwa sk≈Çadnika (np. 'mƒÖka')" value="${name}" required>
                <input type="text" class="ingridient-amount" placeholder="Ilo≈õƒá (np. '200g')" value="${amount}" required>
                <button type="button" class="remove-ingridient-btn" onclick="removeIngredientInput(this)">X</button>
            `;
            
            container.appendChild(group);
            
            group.querySelector('.ingridient-amount').addEventListener('input', checkLastIngredient);
        }

        function removeIngredientInput(button) {
            const container = document.getElementById('ingridient-inputs-container');
            const group = button.parentNode;
            container.removeChild(group);
            checkLastIngredient(); 
        }

        function checkLastIngredient() {
            const container = document.getElementById('ingridient-inputs-container');
            const groups = container.querySelectorAll('.ingridient-input-group');
            
            if (groups.length === 0) {
                 addIngredientInput();
                 return;
            }
            
            const lastGroup = groups[groups.length - 1];
            const nameInput = lastGroup.querySelector('.ingridient-name');
            const amountInput = lastGroup.querySelector('.ingridient-amount');

            if (nameInput.value.trim() !== '' && amountInput.value.trim() !== '') {
                if (container.children.length > 0) {
                    const newGroup = document.createElement('div');
                    newGroup.className = 'ingridient-input-group';
                    newGroup.innerHTML = `
                        <input type="text" class="ingridient-name" placeholder="Nazwa sk≈Çadnika" value="">
                        <input type="text" class="ingridient-amount" placeholder="Ilo≈õƒá" value="">
                        <button type="button" class="remove-ingridient-btn" onclick="removeIngredientInput(this)">X</button>
                    `;
                    container.appendChild(newGroup);
                    newGroup.querySelector('.ingridient-amount').addEventListener('input', checkLastIngredient);
                }
            }
        }

        

        // --- Funkcje Pomocnicze UI ---

        function showMessage(containerId, message, type) {
            const container = document.getElementById(containerId);
            container.textContent = message;
            container.className = `message-box ${type}`;
            container.style.display = 'block';
            setTimeout(() => {
                container.style.display = 'none';
            }, 6000); 
        }

        function navigate(viewId) {
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            const targetView = document.getElementById(viewId);
            if(targetView) {
                 targetView.classList.add('active');
            } else {
                console.error(`Nie znaleziono widoku o ID: ${viewId}`);
                return;
            }
           
            document.getElementById('generate-v1-form').style.display = 'flex';
            document.getElementById('v1-recipe-display').style.display = 'none';
            document.getElementById('generate-v2-form').style.display = 'flex';
            document.getElementById('v2-recipe-display').style.display = 'none';
            document.getElementById('user-edit-form').style.display = 'none';

            if (viewId === 'recipes-view') {
                fetchRecipes();
            } else if (viewId === 'profile-view') {
                fetchUserProfile();
            } else if (viewId === 'generate-recipe-v2-view') {
                const container = document.getElementById('ingridient-inputs-container');
                if (container.children.length === 0) {
                     addIngredientInput(); 
                }
            } else if (viewId === 'admin-view') {
                fetchUsers();
            }
        }

        function updateNav() {
            const nav = document.getElementById('app-nav');
            const token = getToken();
            nav.innerHTML = '';

            console.log('=== DEBUG updateNav ===');
            console.log('Token exists:', !!token);
            console.log('currentUser:', currentUser);
            console.log('currentUser.isAdmin:', currentUser?.isAdmin);
            console.log('typeof isAdmin:', typeof currentUser?.isAdmin);
            console.log('=====================');

            if (token) {
                nav.innerHTML += '<button onclick="navigate(\'recipes-view\')">Moje Przepisy</button>';
                nav.innerHTML += '<button onclick="navigate(\'generate-recipe-v1-view\')">Generuj Intencja</button>';
                nav.innerHTML += '<button onclick="navigate(\'generate-recipe-v2-view\')">Generuj Sk≈Çadniki</button>';
                
                // ‚úÖ POPRAWIONE: Sprawdzanie isAdmin
                const isAdmin = currentUser && (
                    currentUser.isAdmin === true || 
                    currentUser.isAdmin === 'true' ||
                    currentUser.isAdmin === 1
                );
                
                console.log('üîç Czy pokazaƒá panel admina?', isAdmin);
                console.log('üîç Warunek sprawdzania:', {
                    currentUserExists: !!currentUser,
                    isAdminValue: currentUser?.isAdmin,
                    isAdminType: typeof currentUser?.isAdmin,
                    finalResult: isAdmin
                });
                
                if (isAdmin) {
                    nav.innerHTML += '<button onclick="navigate(\'admin-view\')">Panel Admina üõ°Ô∏è</button>';
                    console.log('‚úÖ DODANO PANEL ADMINA DO NAVBAR!');
                } else {
                    console.log('‚ùå NIE DODANO PANELU ADMINA - u≈ºytkownik nie jest adminem');
                    console.log('üí° Przyczyna:', {
                        currentUser: !!currentUser,
                        isAdminValue: currentUser?.isAdmin,
                        expected: true
                    });
                }
                
                nav.innerHTML += '<button onclick="navigate(\'profile-view\')">Profil</button>';
                nav.innerHTML += '<button onclick="logout()">Wyloguj</button>';
                
                if (!document.querySelector('.view.active') || ['login-view', 'register-view'].includes(document.querySelector('.view.active').id)) {
                    navigate('recipes-view');
                }

            } else {
                nav.innerHTML += '<button onclick="navigate(\'login-view\')">Zaloguj</button>';
                nav.innerHTML += '<button onclick="navigate(\'register-view\')">Zarejestruj</button>';
                navigate('login-view');
            }
        }

        function getToken() {
            return localStorage.getItem(TOKEN_KEY);
        }

        async function authFetch(url, options = {}) {
            const token = getToken();
            const headers = {
                ...options.headers,
                'Content-Type': 'application/json'
            };

            if (token) {
                headers['Authorization'] = `Bearer ${token}`;
            }

            return fetch(url, {
                ...options,
                headers
            });
        }
        
        /**
         * Dynamiczne renderowanie przepisu do podanego kontenera.
         * ZOPTYMALIZOWANE DO ODCZYTU ZAGNIE≈ªD≈ªONYCH KLUCZY JAK 'tytul', 'skladniki'.
         */
        function renderRecipeDetails(recipeData, containerId, ownerUsername = 'Nieznany') {
            const contentContainer = document.getElementById(containerId);

            // --- PRAWID≈ÅOWE MAPOWANIE DANYCH Z ZAGNIE≈ªD≈ªONEJ STRUKTURY "recipe" ---
            const data = recipeData.recipe || recipeData; 
            
            const title = data.tytul || data.title || 'Przepis bez Tytu≈Çu';
            const description = data.opis || data.description || data.summary || 'Brak dodatkowego opisu przepisu.';
            const owner = recipeData.ownerUsername || data.ownerUsername || data.user || ownerUsername;
            
            // --- PARSOWANIE SK≈ÅADNIK√ìW ---
            let ingredientsList = 'Brak danych o sk≈Çadnikach.';
            const ingredientsArray = data.skladniki || data.ingredients || []; 
            
            if (Array.isArray(ingredientsArray) && ingredientsArray.length > 0) {
                ingredientsList = ingredientsArray.map(item => {
                    const ilosc = item.ilosc || item.amount || '';
                    const nazwa = item.nazwa || item.name || 'Nieznany sk≈Çadnik';
                    const uwagi = item.uwagi ? ` (${item.uwagi})` : '';
                    return `<li><strong>${ilosc}</strong> ${nazwa}${uwagi}</li>`;
                }).join('');
            } else if (typeof data.ingredients === 'string' && data.ingredients.trim().length > 0) {
                ingredientsList = data.ingredients.split('\n').map(item => item.trim()).filter(item => item.length > 0).map(item => `<li>${item}</li>`).join('');
                if (ingredientsList === '') ingredientsList = 'Brak danych o sk≈Çadnikach.';
            }

            // --- PARSOWANIE INSTRUKCJI ---
            let stepsList = 'Brak danych o krokach.';
            const stepsArray = data.instrukcje || data.steps || data.instructions || []; 

            if (Array.isArray(stepsArray) && stepsArray.length > 0) {
                stepsList = stepsArray.map(step => {
                    const numer = step.krok_nr || step.stepNumber || '';
                    const opis = step.opis || step.description || step.nazwa_kroku || 'Opis kroku nieznany';
                    const czas = step.czas_minuty ? ` (Czas: ${step.czas_minuty} min)` : '';
                    const temperatura = step.temperatura_stopnie_c ? ` (Temp: ${step.temperatura_stopnie_c}¬∞C)` : '';
                    return `<li><strong>Krok ${numer}:</strong> ${opis}${czas}${temperatura}</li>`;
                }).join('');
            } else if (typeof data.steps === 'string' && data.steps.trim().length > 0) {
                stepsList = data.steps.split('\n').map(item => item.trim()).filter(item => item.length > 0).map(item => `<li>${item}</li>`).join('');
                if (stepsList === '') stepsList = 'Brak danych o krokach.';
            }
            
            // --- KOMPLETOWANIE METADANYCH ---
            const recipeId = data._id || data.id || 'Nieznany';
            const czasPrzygotowania = data.czas_przygotowania_minuty || data.preparationTime || '?';
            const czasCalkowity = data.czas_calkowity_minuty || data.totalTime || data.maxTime || '?';
            
            let trudnosc = data.trudnosc || data.dificultyLevel || '?';
            if (trudnosc === 1) trudnosc = "≈Åatwy";
            else if (trudnosc === 2) trudnosc = "≈öredni";
            else if (trudnosc === 3) trudnosc = "Trudny";
            
            const porcje = data.porcje || data.numberOfPortions || '?';
            const uwagiDietetyczne = data.uwagi_dietetyczne || 'Brak danych o diecie.';
            
            const wartosciOdzywcze = data.wartosci_odzywcze_na_porcje || data.nutrition || {};
            const kalorie = wartosciOdzywcze.kalorie_kcal || wartosciOdzywcze.calories || '?';
            const bialko = wartosciOdzywcze.bialko_g || wartosciOdzywcze.protein || '?';
            const weglowodany = wartosciOdzywcze.weglowodany_g || wartosciOdzywcze.carbs || '?';
            const tluszcze = wartosciOdzywcze.tluszcze_g || wartosciOdzywcze.fat || '?';


            contentContainer.innerHTML = `
                <div id="${containerId.replace('-content', '-header')}" style="padding: 20px 0; border-bottom: 1px solid rgba(0, 245, 255, 0.3); margin-bottom: 15px;">
                    <h3>${title}</h3>
                    <p style="color: var(--color-text-light);">ID: ${recipeId}</p>
                    <p><strong>W≈Ça≈õciciel:</strong> ${owner}</p>
                    <p><strong>Czas Przygotowania:</strong> ${czasPrzygotowania} min | <strong>Czas Ca≈Çkowity:</strong> ${czasCalkowity} min | <strong>Trudno≈õƒá:</strong> ${trudnosc}</p>
                    <p><strong>Porcje:</strong> ${porcje}</p>
                </div>

                <h4>Warto≈õci Od≈ºywcze (na porcjƒô)</h4>
                <p>
                   Kalorie: <strong>${kalorie} kcal</strong> | Bia≈Çko: <strong>${bialko} g</strong> | Wƒôglowodany: <strong>${weglowodany} g</strong> | T≈Çuszcze: <strong>${tluszcze} g</strong>
                </p>

                <hr>
                
                <h4>Sk≈Çadniki</h4>
                <ul>${ingredientsList}</ul>
                
                <h4>Instrukcje Przygotowania</h4>
                <ol>${stepsList}</ol>
                
                <h4>Dodatkowy Opis</h4>
                <p style="font-style: italic;">${description}</p>

                <h4>Uwagi Dietetyczne</h4>
                <p>${uwagiDietetyczne}</p>
            `;
            
            if (containerId === 'recipe-display-content') {
                document.getElementById('recipe-details-title').textContent = `Szczeg√≥≈Çy Przepisu (ID: ${recipeId})`;
            }
        }

        // --- Logika API ---

        async function handleRegister(event) {
            event.preventDefault();
            const email = document.getElementById('register-email').value;
            const username = document.getElementById('register-username').value;
            const password = document.getElementById('register-password').value;
            const messageContainerId = 'register-message';
            showLoading();

            try {
                const response = await fetch(`${API_BASE_URL}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password, username })
                });

                if (response.status === 201) {
                    showMessage(messageContainerId, 'Sukces! Link weryfikacyjny wys≈Çany. Zaloguj siƒô po weryfikacji.', 'success');
                    document.getElementById('register-form').reset();
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData.message || response.statusText;
                    showMessage(messageContainerId, `B≈ÇƒÖd (${response.status}): ${errorMessage}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia z serwerem. Upewnij siƒô, ≈ºe API jest uruchomione na ${API_BASE_URL}.`, 'error');
            } finally {
                 hideLoading();
            }
        }

        async function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const messageContainerId = 'login-message';
            showLoading();

            try {
                const response = await fetch(`${API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                if (response.ok) {
                    const data = await response.json();
                    localStorage.setItem(TOKEN_KEY, data.token);
                    showMessage(messageContainerId, 'Zalogowano pomy≈õlnie!', 'success');
                    document.getElementById('login-form').reset();

                    // Je≈õli backend zwraca dane u≈ºytkownika w odpowiedzi login, zaktualizuj currentUser
                    if (data.user) {
                        currentUser = {
                            ...data.user,
                            isAdmin: data.user.idAdmin // Mapuj idAdmin na isAdmin
                        };
                        console.log('‚úÖ Zalogowano - currentUser:', currentUser);
                    }
                    
                    // Zawsze pobierz ≈õwie≈ºe dane profilu
                    await fetchUserProfile();
                    updateNav();

                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd logowania: Nieprawid≈Çowy email lub has≈Ço (${response.status}).`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia z serwerem.`, 'error');
            } finally {
                hideLoading();
            }
        }

        function logout() {
            localStorage.removeItem(TOKEN_KEY);
            currentUser = null;
            showMessage('login-message', 'Wylogowano pomy≈õlnie.', 'success');
            updateNav();
        }

        async function fetchRecipes() {
            const recipeList = document.getElementById('recipe-list');
            const messageContainerId = 'recipes-message';
            recipeList.innerHTML = '<p style="text-align: center; color: var(--color-text-light);">≈Åadowanie przepis√≥w...</p>';
            showLoading();

            try {
                const response = await authFetch(`${API_BASE_URL}/recipe/`, { method: 'GET' });

                if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Sesja wygas≈Ça. Zaloguj siƒô ponownie.', 'error');
                    return;
                }

                if (response.ok) {
                    const data = await response.json();
                    
                    // OBS≈ÅUGA R√ì≈ªNYCH FORMAT√ìW ODPOWIEDZI
                    let recipes = [];
                    
                    if (Array.isArray(data)) {
                        // Przypadek 1: Endpoint zwraca bezpo≈õrednio tablicƒô
                        recipes = data;
                    } else if (data.recipes && Array.isArray(data.recipes)) {
                        // Przypadek 2: Endpoint zwraca obiekt z polem "recipes"
                        recipes = data.recipes;
                    } else {
                        // Nieznany format
                        showMessage(messageContainerId, 'B≈ÇƒÖd: Nieznany format danych z serwera.', 'error');
                        recipeList.innerHTML = '<p style="text-align: center; color: var(--color-error); padding: 20px;">B≈ÇƒÖd danych z API.</p>';
                        return;
                    }
                    
                    recipeList.innerHTML = '';
                    
                    if (recipes.length === 0) {
                        recipeList.innerHTML = `
                            <div style="text-align: center; padding: 40px 20px; color: var(--color-text-light);">
                                <p style="font-size: 1.2em; margin-bottom: 15px;">üìù Nie masz jeszcze ≈ºadnych przepis√≥w</p>
                                <p>U≈ºyj zak≈Çadek w g√≥rnym menu, aby wygenerowaƒá pierwszy przepis!</p>
                            </div>
                        `;
                    } else {
                        recipes.forEach(recipe => {
                            const recipeId = recipe._id || recipe.id; 
                            
                            // Poniewa≈º teraz otrzymujemy bezpo≈õrednio obiekt przepisu
                            const title = recipe.tytul || recipe.title || 'Przepis bez tytu≈Çu';
                            const maxTime = recipe.czas_calkowity_minuty || recipe.totalTime || '?';
                            const dificultyLevel = recipe.trudnosc || recipe.dificultyLevel || '?';
                            
                            const li = document.createElement('li');
                            li.className = 'recipe-item';
                            li.innerHTML = `
                                <div>
                                    <h3>${title}</h3>
                                    <p style="color: var(--color-text-light);">Czas: ${maxTime} min | Trudno≈õƒá: ${dificultyLevel}</p>
                                </div>
                                <div class="recipe-actions">
                                    <button onclick="viewRecipeDetails('${recipeId}')" class="btn-secondary">Szczeg√≥≈Çy</button>
                                    <button onclick="deleteRecipe('${recipeId}')" class="btn btn-danger" style="background: linear-gradient(135deg, var(--color-error), #ff1a40);">Usu≈Ñ</button>
                                </div>
                            `;
                            recipeList.appendChild(li);
                        });
                    }
                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd pobierania przepis√≥w: ${response.statusText}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia: ${error.message}`, 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function handleGenerateV1(event) {
            event.preventDefault();
            const intention = document.getElementById('v1-intention').value;
            const maxTime = parseInt(document.getElementById('v1-maxTime').value);
            const dificultyLevel = parseInt(document.getElementById('v1-dificultyLevel').value);
            const numberOfPortions = document.getElementById('v1-numberOfPortions').value ? parseInt(document.getElementById('v1-numberOfPortions').value) : undefined;
            const messageContainerId = 'generate-v1-message';
            
            showMessage(messageContainerId, 'Trwa generowanie przepisu przez AI...', 'success');
            showLoading(); 

            try {
                const response = await authFetch(`${API_BASE_URL}/recipe/generateV1`, {
                    method: 'POST',
                    body: JSON.stringify({ intention, maxTime, dificultyLevel, numberOfPortions })
                });

                if (response.status === 201) {
                    const newRecipe = await response.json();
                    
                    document.getElementById('generate-v1-form').style.display = 'none';
                    document.getElementById('v1-recipe-display').style.display = 'block';
                    
                    renderRecipeDetails(newRecipe, 'v1-recipe-content', currentUser ? currentUser.username : 'AI');

                    showMessage(messageContainerId, 'Przepis pomy≈õlnie wygenerowany i zapisany!', 'success');
                    
                } else if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Brak autoryzacji. Zaloguj siƒô ponownie.', 'error');
                } else if (response.status === 200) {
                    const errorData = await response.json().catch(() => ({}));
                    showMessage(messageContainerId, `AI: ${errorData.message || 'Model AI nie mo≈ºe stworzyƒá racjonalnego przepisu.'}`, 'error');
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    showMessage(messageContainerId, `B≈ÇƒÖd generowania (${response.status}): ${errorData.message || response.statusText}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia.`, 'error');
            } finally {
                hideLoading(); 
            }
        }

        async function handleGenerateV2(event) {
            event.preventDefault();
            
            const ingridientGroups = document.querySelectorAll('.ingridient-input-group');
            const ingredients = [];
            
            ingridientGroups.forEach(group => {
                const name = group.querySelector('.ingridient-name').value.trim();
                const amount = group.querySelector('.ingridient-amount').value.trim();
                
                if (name) {
                    ingredients.push(`${name}: ${amount}`);
                }
            });

            if (ingredients.length === 0) {
                showMessage('generate-v2-message', 'Musisz podaƒá co najmniej jeden sk≈Çadnik.', 'error');
                return;
            }
            
            const ingridientList = ingredients.join(', ');
            
            const maxTime = parseInt(document.getElementById('v2-maxTime').value);
            const dificultyLevel = parseInt(document.getElementById('v2-dificultyLevel').value);
            const numberOfPortions = document.getElementById('v2-numberOfPortions').value ? parseInt(document.getElementById('v2-numberOfPortions').value) : undefined;
            const messageContainerId = 'generate-v2-message';

            showMessage(messageContainerId, `Trwa generowanie przepisu przez AI z listy: ${ingridientList}...`, 'success');
            showLoading(); 

            try {
                const response = await authFetch(`${API_BASE_URL}/recipe/generateV2`, {
                    method: 'POST',
                    body: JSON.stringify({ ingridientList, maxTime, dificultyLevel, numberOfPortions }) 
                });

                if (response.status === 201) {
                    const newRecipe = await response.json();
                    
                    document.getElementById('generate-v2-form').style.display = 'none';
                    document.getElementById('v2-recipe-display').style.display = 'block';
                    
                    renderRecipeDetails(newRecipe, 'v2-recipe-content', currentUser ? currentUser.username : 'AI');

                    showMessage(messageContainerId, 'Przepis pomy≈õlnie wygenerowany i zapisany!', 'success');
                } else if (response.status === 200) {
                    const errorData = await response.json().catch(() => ({}));
                    showMessage(messageContainerId, `AI: ${errorData.message || 'Model AI nie mo≈ºe stworzyƒá racjonalnego przepisu z tych sk≈Çadnik√≥w. Spr√≥buj zmieniƒá listƒô.'}`, 'error');
                } else if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Brak autoryzacji. Zaloguj siƒô ponownie.', 'error');
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    showMessage(messageContainerId, `B≈ÇƒÖd generowania (${response.status}): ${errorData.message || response.statusText}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia.`, 'error');
            } finally {
                hideLoading(); 
            }
        }

        async function deleteRecipe(recipeId) {
            if (!confirm(`Czy na pewno usunƒÖƒá przepis ID: ${recipeId}?`)) return;
            const messageContainerId = 'recipes-message';
            showLoading();

            try {
                const response = await authFetch(`${API_BASE_URL}/recipe/${recipeId}`, { method: 'DELETE' });

                if (response.status === 200) {
                    showMessage(messageContainerId, `Przepis pomy≈õlnie usuniƒôty.`, 'success');
                    fetchRecipes(); 
                } else if (response.status === 403) {
                    showMessage(messageContainerId, 'Brak uprawnie≈Ñ do usuniƒôcia tego przepisu.', 'error');
                } else if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Brak autoryzacji.', 'error');
                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd usuwania: ${response.statusText}`, 'error');
                }
            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia.`, 'error');
            } finally {
                 hideLoading();
            }
        }
        
        /**
         * FUNKCJA VIEW RECIPE DETAILS
         */
        async function viewRecipeDetails(recipeId) {
            const messageContainerId = 'recipe-details-message';
            const contentContainerId = 'recipe-display-content';
            
            if (!recipeId) {
                showMessage(messageContainerId, 'B≈ÇƒÖd: Brak ID przepisu do wy≈õwietlenia.', 'error');
                return;
            }
            
            navigate('recipe-details-view'); 
            
            document.getElementById(contentContainerId).innerHTML = '<p style="text-align: center; color: var(--color-text-light);">≈Åadowanie szczeg√≥≈Ç√≥w przepisu...</p>';
            showLoading(); 

            try {
                const response = await authFetch(`${API_BASE_URL}/recipe/${recipeId}`, { method: 'GET' });

                if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Brak autoryzacji.', 'error');
                    return;
                }
                
                if (response.status === 404) {
                    document.getElementById(contentContainerId).innerHTML = '<p style="text-align: center; color: var(--color-error);">Przepis nie znaleziony.</p>';
                    return;
                }

                if (response.ok) {
                    const fullData = await response.json();
                    renderRecipeDetails(fullData, contentContainerId);
                    showMessage(messageContainerId, 'Szczeg√≥≈Çy przepisu za≈Çadowane.', 'success');
                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd ≈Çadowania: ${response.statusText}`, 'error');
                    document.getElementById(contentContainerId).innerHTML = '<p style="text-align: center; color: var(--color-error);">WystƒÖpi≈Ç b≈ÇƒÖd podczas ≈Çadowania danych.</p>';
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia: ${error.message}`, 'error');
                document.getElementById(contentContainerId).innerHTML = '<p style="text-align: center; color: var(--color-error);">B≈ÇƒÖd po≈ÇƒÖczenia z serwerem API.</p>';
            } finally {
                hideLoading(); 
            }
        }

        async function fetchUserProfile() {
            const messageContainerId = 'profile-message';
            document.getElementById('user-email').textContent = '≈Åadowanie...';
            document.getElementById('user-username').textContent = '≈Åadowanie...';
            document.getElementById('user-isAdmin').textContent = '≈Åadowanie...';
            showLoading();

            try {
                const response = await authFetch(`${API_BASE_URL}/user/me`, { method: 'GET' });

                if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Sesja wygas≈Ça. Zaloguj siƒô ponownie.', 'error');
                    return;
                }

                if (response.ok) {
                    const userData = await response.json();
                    
                    console.log('=== DEBUG fetchUserProfile ===');
                    console.log('Pe≈Çna odpowied≈∫ z API:', userData);
                    console.log('isAdmin z API:', userData.isAdmin);
                    console.log('============================');
                    
                    // ‚úÖ POPRAWIONE: U≈ºyj isAdmin z API (bo backend teraz zwraca isAdmin: true)
                    currentUser = {
                        ...userData,
                        isAdmin: userData.isAdmin // Backend zwraca isAdmin, nie idAdmin
                    };
                    
                    console.log('‚úÖ currentUser po mapowaniu:', currentUser);
                    
                    document.getElementById('user-email').textContent = currentUser.email || 'Brak danych';
                    document.getElementById('user-username').textContent = currentUser.username || 'Brak danych';
                    
                    // Wy≈õwietl status admina
                    const isAdmin = currentUser.isAdmin === true || currentUser.isAdmin === 'true';
                    document.getElementById('user-isAdmin').textContent = isAdmin ? 'Administrator üõ°Ô∏è' : 'U≈ºytkownik';
                    document.getElementById('user-isAdmin').style.color = isAdmin ? 'var(--color-neon-admin)' : 'var(--color-text)';
                    
                    showMessage(messageContainerId, 'Dane profilu za≈Çadowane.', 'success');
                    
                    // Wa≈ºne: od≈õwie≈º navbar po pobraniu danych
                    updateNav();
                    
                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd pobierania danych: ${response.statusText}`, 'error');
                }
            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia.`, 'error');
            } finally {
                hideLoading();
            }
        }

        async function handleUpdateProfile(event) {
            event.preventDefault();
            const newEmail = document.getElementById('newEmail').value;
            const newPassword = document.getElementById('newPassword').value;
            const newUsername = document.getElementById('newUsername').value;
            const messageContainerId = 'profile-message';

            const updateData = {};
            if (newEmail) updateData.newEmail = newEmail;
            if (newPassword) updateData.newPassword = newPassword;
            if (newUsername) updateData.newUsername = newUsername;

            if (Object.keys(updateData).length === 0) {
                showMessage(messageContainerId, 'Musisz podaƒá co najmniej jedno pole do aktualizacji.', 'error');
                return;
            }
            showLoading();

            try {
                const response = await authFetch(`${API_BASE_URL}/user/me`, {
                    method: 'PATCH',
                    body: JSON.stringify(updateData)
                });

                if (response.status === 200) {
                    const updatedUser = await response.json();
                    showMessage(messageContainerId, 'Profil pomy≈õlnie zaktualizowany.', 'success');
                    document.getElementById('update-profile-form').reset();
                    
                    // Aktualizuj currentUser z nowymi danymi
                    if (updatedUser.user) {
                        currentUser = { ...currentUser, ...updatedUser.user };
                    }
                    fetchUserProfile(); 
                } else if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Brak autoryzacji.', 'error');
                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd aktualizacji: ${response.statusText}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia.`, 'error');
            } finally {
                 hideLoading();
            }
        }

        async function handleDeleteAccount(event) {
            event.preventDefault();
            const password = document.getElementById('currentPassword').value;
            const messageContainerId = 'delete-message';

            if (!confirm("OSTRZE≈ªENIE: Czy na pewno trwale usunƒÖƒá swoje konto? Tego nie da siƒô cofnƒÖƒá.")) return;
            showLoading();

            try {
                const response = await authFetch(`${API_BASE_URL}/user/me`, {
                    method: 'DELETE',
                    body: JSON.stringify({ password })
                });

                if (response.status === 200) {
                    showMessage('login-message', 'Konto pomy≈õlnie usuniƒôte. Zosta≈Çe≈õ wylogowany.', 'success');
                    logout(); 
                } else if (response.status === 401) {
                    showMessage(messageContainerId, 'Nieprawid≈Çowe has≈Ço lub brak autoryzacji.', 'error');
                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd usuwania konta: ${response.statusText}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia.`, 'error');
            } finally {
                 hideLoading();
            }
        }

        // --- PANEL ADMINA ---

        async function fetchUsers() {
            const userList = document.getElementById('user-list');
            const messageContainerId = 'admin-message';
            userList.innerHTML = '<p style="text-align: center; color: var(--color-text-light);">≈Åadowanie u≈ºytkownik√≥w...</p>';
            showLoading();

            try {
                const response = await authFetch(`${API_BASE_URL}/admin/users`, { method: 'GET' });

                if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Sesja wygas≈Ça. Zaloguj siƒô ponownie.', 'error');
                    return;
                }

                if (response.status === 403) {
                    showMessage(messageContainerId, 'Brak uprawnie≈Ñ administratora.', 'error');
                    userList.innerHTML = '<p style="text-align: center; color: var(--color-error); padding: 20px;">Nie masz uprawnie≈Ñ do przeglƒÖdania tej sekcji.</p>';
                    return;
                }

                if (response.ok) {
                    const users = await response.json();
                    userList.innerHTML = '';
                    
                    if (!Array.isArray(users)) {
                        showMessage(messageContainerId, 'B≈ÇƒÖd: Serwer zwr√≥ci≈Ç niepoprawny format danych.', 'error');
                        userList.innerHTML = '<p style="text-align: center; color: var(--color-error); padding: 20px;">B≈ÇƒÖd danych z API.</p>';
                        return;
                    }
                    
                    // Aktualizuj statystyki
                    const totalUsers = users.length;
                    const adminUsers = users.filter(user => user.isAdmin === true).length;
                    
                    document.getElementById('users-count').textContent = totalUsers;
                    document.getElementById('admins-count').textContent = adminUsers;
                    
                    if (users.length === 0) {
                        userList.innerHTML = `
                            <div style="text-align: center; padding: 40px 20px; color: var(--color-text-light);">
                                <p style="font-size: 1.2em; margin-bottom: 15px;">üìù Brak zarejestrowanych u≈ºytkownik√≥w</p>
                            </div>
                        `;
                    } else {
                        users.forEach(user => {
                            const userId = user._id || user.id; 
                            const isAdmin = user.isAdmin === true;
                            
                            const li = document.createElement('li');
                            li.className = 'user-item';
                            li.innerHTML = `
                                <div>
                                    <h3>${user.username || 'Brak nazwy'} ${isAdmin ? '<span class="admin-badge">ADMIN</span>' : ''}</h3>
                                    <p style="color: var(--color-text-light);">Email: ${user.email || 'Brak emaila'}</p>
                                    <p>ID: ${userId}</p>
                                    <p>Status: ${isAdmin ? 'Administrator' : 'U≈ºytkownik'}</p>
                                </div>
                                <div class="user-actions">
                                    <button onclick="editUser('${userId}')" class="btn-warning">Edytuj</button>
                                    <button onclick="deleteUser('${userId}', '${user.email}')" class="btn btn-danger">Usu≈Ñ</button>
                                </div>
                            `;
                            userList.appendChild(li);
                        });
                    }
                } else {
                    showMessage(messageContainerId, `B≈ÇƒÖd pobierania u≈ºytkownik√≥w: ${response.statusText}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia: ${error.message}`, 'error');
            } finally {
                hideLoading();
            }
        }

        async function editUser(userId) {
            showLoading();
            try {
                const response = await authFetch(`${API_BASE_URL}/admin/user/${userId}`, { method: 'GET' });

                if (response.ok) {
                    const userData = await response.json();
                    const user = userData.user || userData;
                    
                    // Wype≈Çnij formularz danymi u≈ºytkownika
                    document.getElementById('edit-user-id').value = user._id || user.id;
                    document.getElementById('edit-user-email').value = user.email || '';
                    document.getElementById('edit-user-username').value = user.username || '';
                    document.getElementById('edit-user-isAdmin').value = user.isAdmin ? 'true' : 'false';
                    document.getElementById('edit-user-password').value = '';
                    
                    document.getElementById('user-form-title').textContent = 'Edycja U≈ºytkownika';
                    document.getElementById('user-edit-form').style.display = 'block';
                    document.getElementById('user-form-message').style.display = 'none';
                    
                    // Przewi≈Ñ do formularza
                    document.getElementById('user-edit-form').scrollIntoView({ behavior: 'smooth' });
                } else {
                    showMessage('user-form-message', `B≈ÇƒÖd pobierania danych u≈ºytkownika: ${response.statusText}`, 'error');
                }
            } catch (error) {
                showMessage('user-form-message', `B≈ÇƒÖd po≈ÇƒÖczenia: ${error.message}`, 'error');
            } finally {
                hideLoading();
            }
        }

        function showAddUserForm() {
            // Wyczy≈õƒá formularz
            document.getElementById('edit-user-id').value = '';
            document.getElementById('edit-user-email').value = '';
            document.getElementById('edit-user-username').value = '';
            document.getElementById('edit-user-password').value = '';
            document.getElementById('edit-user-isAdmin').value = 'false';
            
            document.getElementById('user-form-title').textContent = 'Dodaj Nowego U≈ºytkownika';
            document.getElementById('user-edit-form').style.display = 'block';
            document.getElementById('user-form-message').style.display = 'none';
            
            // Przewi≈Ñ do formularza
            document.getElementById('user-edit-form').scrollIntoView({ behavior: 'smooth' });
        }

        function hideUserForm() {
            document.getElementById('user-edit-form').style.display = 'none';
        }

        async function handleAdminUserForm(event) {
            event.preventDefault();
            const userId = document.getElementById('edit-user-id').value;
            const email = document.getElementById('edit-user-email').value;
            const username = document.getElementById('edit-user-username').value;
            const password = document.getElementById('edit-user-password').value;
            const isAdmin = document.getElementById('edit-user-isAdmin').value === 'true';
            const messageContainerId = 'user-form-message';
            
            showLoading();

            try {
                const updateData = {
                    newEmail: email,
                    newUsername: username,
                    isAdmin: isAdmin
                };

                if (password) {
                    updateData.newPassword = password;
                }

                let response;
                if (userId) {
                    // Edycja istniejƒÖcego u≈ºytkownika
                    response = await authFetch(`${API_BASE_URL}/admin/user/update/${userId}`, {
                        method: 'PATCH',
                        body: JSON.stringify(updateData)
                    });
                } else {
                    // TODO: Dodaj endpoint do tworzenia u≈ºytkownik√≥w przez admina
                    showMessage(messageContainerId, 'Tworzenie u≈ºytkownik√≥w przez panel admina nie jest jeszcze zaimplementowane.', 'error');
                    hideLoading();
                    return;
                }

                if (response.ok) {
                    showMessage(messageContainerId, 'U≈ºytkownik pomy≈õlnie zaktualizowany.', 'success');
                    document.getElementById('admin-user-form').reset();
                    hideUserForm();
                    fetchUsers(); // Od≈õwie≈º listƒô u≈ºytkownik√≥w
                } else if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Brak autoryzacji.', 'error');
                } else if (response.status === 403) {
                    showMessage(messageContainerId, 'Brak uprawnie≈Ñ do edycji u≈ºytkownik√≥w.', 'error');
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    showMessage(messageContainerId, `B≈ÇƒÖd aktualizacji: ${errorData.message || response.statusText}`, 'error');
                }

            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia: ${error.message}`, 'error');
            } finally {
                hideLoading();
            }
        }

        async function deleteUser(userId, userEmail) {
            if (!confirm(`Czy na pewno chcesz usunƒÖƒá u≈ºytkownika ${userEmail}? Ta operacja jest nieodwracalna.`)) return;
            const messageContainerId = 'admin-message';
            showLoading();

            try {
                const response = await authFetch(`${API_BASE_URL}/admin/user/delete/${userId}`, { method: 'DELETE' });

                if (response.ok) {
                    showMessage(messageContainerId, `U≈ºytkownik ${userEmail} zosta≈Ç pomy≈õlnie usuniƒôty.`, 'success');
                    fetchUsers(); // Od≈õwie≈º listƒô u≈ºytkownik√≥w
                } else if (response.status === 401) {
                    logout();
                    showMessage(messageContainerId, 'Brak autoryzacji.', 'error');
                } else if (response.status === 403) {
                    showMessage(messageContainerId, 'Brak uprawnie≈Ñ do usuwania u≈ºytkownik√≥w.', 'error');
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    showMessage(messageContainerId, `B≈ÇƒÖd usuwania: ${errorData.message || response.statusText}`, 'error');
                }
            } catch (error) {
                showMessage(messageContainerId, `B≈ÇƒÖd po≈ÇƒÖczenia: ${error.message}`, 'error');
            } finally {
                 hideLoading();
            }
        }

        // --- Inicjalizacja Aplikacji ---
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('register-form').addEventListener('submit', handleRegister);
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            document.getElementById('generate-v1-form').addEventListener('submit', handleGenerateV1);
            document.getElementById('generate-v2-form').addEventListener('submit', handleGenerateV2);
            document.getElementById('update-profile-form').addEventListener('submit', handleUpdateProfile);
            document.getElementById('delete-account-form').addEventListener('submit', handleDeleteAccount);
            document.getElementById('admin-user-form').addEventListener('submit', handleAdminUserForm);
            
            const container = document.getElementById('ingridient-inputs-container');
            if (container.children.length === 0) {
                addIngredientInput(); 
            }

            // NAJPIERW sprawd≈∫ czy u≈ºytkownik jest zalogowany i pobierz jego dane
            const token = getToken();
            if (token) {
                console.log('üîÑ Token znaleziony, pobieram dane u≈ºytkownika...');
                fetchUserProfile().then(() => {
                    console.log('‚úÖ Dane u≈ºytkownika pobrane, teraz aktualizujƒô navbar');
                    console.log('üìä currentUser:', currentUser);
                    console.log('üìä isAdmin:', currentUser?.isAdmin);
                    updateNav();
                }).catch(error => {
                    console.error('‚ùå B≈ÇƒÖd pobierania danych u≈ºytkownika:', error);
                    updateNav();
                });
            } else {
                console.log('‚ùå Brak tokenu, wy≈õwietlam login');
                updateNav();
            }
        });
    </script>

</body>
</html>